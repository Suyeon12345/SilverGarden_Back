<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mybatis.mapper.AngelMapper">
    <resultMap id="programResultMap" type="com.sg.back.angel.vo.ProgramVO">
        <result property="PG_START" column="PG_START" javaType="java.lang.String" />
        <result property="PG_END" column="PG_END" javaType="java.lang.String" />
    </resultMap>
    <!--프로그램 추가-->
    <insert id="pgInsert" parameterType="java.util.Map">
        insert into  PROGRAM(pg_no,  pg_name, pg_start, pg_end, pg_daysofweek, pg_teacher,pg_category, pg_content)
        values(seq_program_no.nextval, #{pg_name}, TO_DATE(#{pg_start}, 'YYYY-MM-DD'), TO_DATE(#{pg_end}, 'YYYY-MM-DD'),#{pg_daysofweek},#{pg_teacher},#{pg_category},#{pg_content})
    </insert>
    <!--프로그램 조회-->
    <select id="pgList" parameterType="java.util.Map" resultType="java.util.Map">
        select * from PROGRAM
        <where>
            <if test = "pg_no!=null">And pg_no=#{pg_no}</if>
            <if test ="gubun!=null">
                <choose>
                    <when test='gubun.equals("pg_no")'>
                        AND pg_no LIKE %||#{keyword}||'%'
                    </when>
                    <when test='gubun.equals("pg_name")'>
                        AND pg_name LIKE %||#{keyword}||'%'
                    </when>
                    <when test='gubun.equals("pg_teacher")'>
                        AND pg_teacher LIKE %||#{keyword}||'%'
                    </when>
                    <when test='gubun.equals("pg_category")'>
                        AND pg_category LIKE %||#{keyword}||'%'
                    </when>
                    <when test='gubun.equals("pg_content")'>
                        AND pg_content LIKE %||#{keyword}||'%'
                    </when>
                </choose>
            </if>
        </where>
        order by pg_no desc
    </select>
    <!--    업데이트(수정)-->
    <update id="pgUpdate"  parameterType="java.util.Map">
        update PROGRAM set
                                pg_name = #{pg_name},
                                pg_category = #{pg_category},
                                pg_teacher = #{pg_teacher},
                                pg_daysofweek = #{pg_daysofweek},
                                pg_start = #{pg_start},
                                pg_end = #{pg_end},
                                pg_content = #{pg_content}
        where pg_no = #{pg_no}
    </update>

    <select id="scheduleList" resultMap="programResultMap" parameterType="java.util.Map">
        SELECT PG_NO, PG_NAME, PG_START, PG_END, PG_DAYSOFWEEK, PG_CATEGORY, PG_TEACHER, PG_CONTENT
        FROM PROGRAM
    </select>
</mapper>
